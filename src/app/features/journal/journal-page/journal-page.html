<section class="card">
  <h1>Diario emocional</h1>

  <p class="muted">
    Puedes escribir con calma cÃ³mo te sientes y quÃ© ha pasado en tu dÃ­a.
  </p>

  <form (ngSubmit)="addEntry()">
    <div class="field">
      <label class="label">Estado principal de la entrada</label>

      <select
        [(ngModel)]="mood"
        name="mood"
        required
        [ngClass]="{ 'input-error': showErrors && !mood }"
      >
        <option value="">Seleccionar estadoâ€¦</option>
        <option *ngFor="let m of moods" [value]="m">{{ m }}</option>
      </select>

      <p class="error" *ngIf="showErrors && !mood">
        Selecciona un estado emocional.
      </p>
    </div>

    <div class="field">
      <label class="label">Entrada del dÃ­a</label>

      <textarea
        [(ngModel)]="text"
        name="text"
        rows="5"
        [ngClass]="{ 'input-error': showErrors && !text.trim() }"
        placeholder="Escribe lo que necesites..."
      ></textarea>

      <p class="error" *ngIf="showErrors && !text.trim()">
        Escribe algo para guardar la entrada.
      </p>
    </div>

    <button type="submit" class="btn">Guardar entrada ğŸ“</button>
  </form>

  <hr class="divider">

  <p class="muted" *ngIf="entries.length === 0">
    Tu diario estÃ¡ vacÃ­o.  
    Puedes comenzar con algo sencillo como:
    <em>â€œHoy he decidido escucharmeâ€.</em>
  </p>

  <ul class="journal-list" *ngIf="entries.length > 0">
    <li *ngFor="let entry of entries" [ngClass]="{ important: entry.important }">
      
      <div class="journal-header">
        <span class="badge">{{ entry.mood }}</span>
        <span class="date">{{ entry.date | date:'short' }}</span>
      </div>

      <p class="journal-text">
        {{ entry.text | shortText:220 }}
      </p>

      <div class="actions">
        <button type="button" (click)="toggleImportant(entry)">
          {{ entry.important ? 'Quitar destacado' : 'Marcar importante' }}
        </button>

        <button type="button" class="danger" (click)="removeEntry(entry.id!)">
          Eliminar
        </button>
      </div>

    </li>
  </ul>
</section>
