<section class="card">
  <h1>Check-in emocional</h1>

  <p class="muted">
    <strong>Registro rápido</strong> de cómo te sientes en este momento.
  </p>

  <form #checkForm="ngForm" (ngSubmit)="registrar(checkForm)">
    <div class="field">
      <label for="estado" class="label">¿Cómo te sientes ahora mismo?</label>

      <select
        id="estado"
        name="estado"
        [(ngModel)]="estadoActual"
        required
        #estadoCtrl="ngModel"
        [ngClass]="{ 'input-error': mostrarError && !estadoActual }"
      >
        <option value="">Seleccionar estado…</option>
        <option *ngFor="let e of estados" [value]="e">{{ e }}</option>
      </select>

      <p class="error" *ngIf="mostrarError">
        Debes seleccionar al menos un estado para registrar el check-in.
      </p>
    </div>

    <div class="field">
      <label class="label">Mensaje corto (opcional)</label>
      <textarea
        name="nota"
        rows="2"
        [(ngModel)]="nota"
        placeholder="Ej: “Hoy me siento agobiada pero intentando estar tranquila”."
      ></textarea>
      <p class="hint">
       Registra cómo te sientes ahora.
      </p>
    </div>

    <button type="submit" class="btn">
      Registrar estado ✨
    </button>
  </form>

  <hr class="divider" />

  <h2 class="subtitulo">Tus últimos check-ins</h2>

  <p *ngIf="historial.length === 0" class="muted">
    Aún no has registrado ningún estado. Haz tu primer check-in para empezar a ver tu evolución.
  </p>

  <ul class="historial" *ngIf="historial.length > 0">
    <li *ngFor="let h of historial">
      <div class="row">
        <span class="estado">{{ h.estado }}</span>
        <span class="fecha">{{ h.fecha | date: 'short' }}</span>
      </div>

      <p class="nota" *ngIf="h.nota">{{ h.nota }}</p>
    </li>
  </ul>
</section>
