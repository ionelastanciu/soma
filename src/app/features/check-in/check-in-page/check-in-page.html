<section class="card">
  <h1>Check-in emocional</h1>
  <p class="muted">Selecciona cómo te sientes hoy para recibir recomendaciones personalizadas.</p>

  <!-- FORMULARIO TEMPLATE-DRIVEN -->
  <form #checkForm="ngForm" (ngSubmit)="registrar(checkForm)">

    <!-- Selector de estado -->
    <div class="selector field">
      <label for="estado" class="label">¿Cómo te sientes?</label>

      <select
        id="estado"
        name="estado"
        [(ngModel)]="estadoActual"
        #estadoCtrl="ngModel"
      >
        <option value="">Seleccionar estado…</option>
        <option *ngFor="let e of estados" [value]="e">{{ e }}</option>
      </select>

      <!-- Mensaje de error SOLO cuando el usuario pulsa Registrar -->
      <p class="error" *ngIf="mostrarError">
        Debes seleccionar un estado emocional.
      </p>
    </div>

    <!-- Campo de texto opcional -->
    <div class="field">
      <label class="label">Mensaje (opcional)</label>
      <textarea
        name="nota"
        rows="3"
        [(ngModel)]="nota"
        placeholder="¿Quieres añadir un pequeño mensaje?"
      ></textarea>
    </div>

    <!-- Botón siempre habilitado (como me pediste) -->
    <button type="submit" class="btn">
      Registrar estado ✨
    </button>

  </form>

  <hr class="divider">

  <!-- Historial vacío -->
  <p *ngIf="historial.length === 0" class="muted">
    Aún no has registrado ningún estado.
  </p>

  <!-- Listado de historial -->
  <ul class="historial" *ngIf="historial.length > 0">
    <li *ngFor="let h of historial">
      <div class="row">
        <span class="estado">{{ h.estado }}</span>
        <span class="fecha">{{ h.fecha | date:'short' }}</span>
      </div>

      <p class="nota" *ngIf="h.nota">{{ h.nota }}</p>
    </li>
  </ul>

</section>
