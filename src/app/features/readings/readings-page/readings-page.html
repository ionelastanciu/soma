<!-- LISTA PRINCIPAL DE LECTURAS -->
<section class="card">
  <h1>Lecturas y citas</h1>
  <p class="muted">
    PequeÃ±as lecturas y frases para acompaÃ±ar tu estado emocional.
  </p>

  <div class="toolbar">
    <input
      type="text"
      [(ngModel)]="search"
      placeholder="Buscar por tÃ­tulo, autor o estado (estrÃ©s, gratitud, etc.)"
    />
    <span class="muted" *ngIf="search">
      Filtro activo: "{{ search }}"
    </span>
  </div>

  <p class="muted" *ngIf="filteredReadings.length === 0">
    No hay lecturas que coincidan con tu bÃºsqueda.
  </p>

  <ul class="reading-list" *ngIf="filteredReadings.length > 0">
    <li
      class="reading-row"
      *ngFor="let r of filteredReadings"
      [ngClass]="{ favored: r.favorited }"
    >
      <div class="meta">
        <div>
          <strong>{{ r.title }}</strong>
          <span class="tag"> Â· {{ r.moodTag }}</span>
        </div>
        <div class="sub">
          <span>{{ r.author }}</span>
          <span> Â· {{ r.minutes }} min</span>
        </div>
      </div>

      <!-- ğŸ‘‡ aquÃ­ estÃ¡ el cambio importante -->
      <button
        type="button"
        class="fav-btn"
        (click)="toggleFavorite(r)"
      >
        {{ r.favorited ? 'â˜… Favorito' : 'â˜† Guardar' }}
      </button>
    </li>
  </ul>
</section>

<!-- BLOQUE DE LIBROS RECOMENDADOS CON API -->
<section class="card">
  <h1>ğŸ“š Libros recomendados</h1>
  <p class="muted">
    Descubre libros reales segÃºn tu bÃºsqueda. Pulsa â€œBuscarâ€ para ver sugerencias.
  </p>

  <!-- Buscador -->
  <div class="toolbar">
    <input
      type="text"
      [(ngModel)]="searchBooks"
      placeholder="Buscar libros (ej. ansiedad, calma, autoayuda)"
    />
    <button class="btn" (click)="buscarLibros()">Buscar</button>
  </div>

  <!-- Estado de carga -->
  <p *ngIf="cargando">Buscando libros...</p>
  <p *ngIf="error" class="error">Error al cargar libros ğŸ˜¢</p>

  <!-- Lista -->
  <ul class="reading-list" *ngIf="libros.length > 0">
    <li class="reading-row" *ngFor="let b of libros">
      <div class="meta">
        <strong>{{ b.titulo }}</strong>
        <div class="sub">{{ b.autor }}</div>
      </div>

      <div *ngIf="b.portada">
        <img [src]="b.portada" alt="Portada del libro" width="70" />
      </div>

      <button class="fav-btn" (click)="guardarLibro(b)">
        â˜† Guardar
      </button>
    </li>
  </ul>

  <p class="muted" *ngIf="!libros.length && !cargando">
    Escribe algo arriba para empezar la bÃºsqueda.
  </p>
</section>
